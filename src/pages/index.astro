---
import Layout from '../layouts/Layout.astro'

import { profile } from '@/settings'
import { experiences, education } from '@/data/cv'
import ProfilePictures from '@/assets/profile_pictures.jpg'
import Hero from '@/components/ui/Hero.astro'
import CvTimeline from '@/components/ui/CvTimeline.astro'
import type { Experience, Education } from '@/types/cv'

const { fullName, title, institute } = profile

let orderedExperiences: Experience[] = []
let orderedEducations: Education[] = []

const orderElement = <T extends { time: string }>(a: T, b: T) => {
	const presentValues = ['present', 'now', 'current', 'today']
	if (presentValues.includes((a.time as string)?.split(' - ')[1]?.toLowerCase())) {
		return -1
	}
	const dateA = new Date((a.time as string)?.split(' - ')[1])
	const dateB = new Date((b.time as string)?.split(' - ')[1])
	return dateB.getTime() - dateA.getTime()
}

if (experiences.length > 0) {
	orderedExperiences = experiences.sort((a, b) => orderElement(a, b))
}

if (education.length > 0) {
	orderedEducations = education.sort((a, b) => orderElement(a, b))
}

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout>
	<!-- Hero Section -->
	<section class='flex items-center gap-12 border-b pb-12'>
		<Hero
			fullName={fullName}
			title={title}
			institute={institute}
			profilePicture={ProfilePictures}
		/>
	</section>

	<section class='pt-10'>
		<h2 class='text-2xl font-bold mb-4'>About Me</h2>
		<div class='space-y-4 text-base-content/90 leading-relaxed'>
			<p>
				I'm a Machine Learning Engineer at Adobe, currently working on foundation models for video generation and editing within the Firefly team. Previously, at Rephrase.ai, I contributed to the Zero-shot Talking Avatar model by building a large-scale, diverse talkinghead dataset. After Adobe acquired Rephrase.ai, this model was deployed on the Adobe Firefly platform as Translate Video.
			</p>
			<p>
				Before working on generative video systems, I was at Zomato, where I developed and deployed APIs for face recognition and liveliness detection, along with image enhancement and tagging models. I began my career at Samsung, working on gesture recognition, human action classification, and neural network based wireless signal compression.
			</p>
			<p>
				I graduated from IIT Kharagpur with a B.Tech in Electronics and Electrical Communication and a minor in Computer Science.
			</p>
		</div>
	</section>

	<section class='pt-12'>
		{
			orderedEducations.length > 0 && (
				<section id='education' class='mb-12'>
					<h3 class='text-xl font-bold mb-6 border-b pb-2'>Education</h3>
					<CvTimeline elements={orderedEducations} colored={true} />
				</section>
			)
		}

		{
			orderedExperiences.length > 0 && (
				<section id='experience' class='mb-12'>
					<h3 class='text-xl font-bold mb-6 border-b pb-2'>Experience</h3>
					<CvTimeline elements={orderedExperiences} colored={true} />
				</section>
			)
		}
	</section>
</Layout>
